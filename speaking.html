<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Speaking</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main>
        <h1>Speaking</h1>
        <p>
            I：主観的<br>
            It：客観的<br>
            動詞の原形：確定している動作<br>
            to do：確定している動作に向かう<br>
            that SV：論理的
        </p>
        <p>
            do：動詞原形（一般動詞の原形、be+形容詞）<br>
            done：過去分詞（一般動詞の過去分詞、been+形容詞）<br>
            adj：形容詞型（形容詞、分詞）
        </p>
        <select id="category" onchange="loadData()" aria-label="カテゴリ選択">
            <option value="basic.json">基本表現</option>
            <option value="to-do.json">動作に向かう（to do）</option>
            <option value="emotion.json">何かに対する感情</option>
            <option value="thinking.json">意見（I think + 文）</option>
            <option value="recognition.json">認識（I know + 文）</option>
        </select>
        <select id="filter" onchange="filterList()" aria-label="選択">
            <option value="主張">主張</option>
            <option value="一般論">一般論</option>
            <option value="質問">質問</option>
        </select>
        <ul id="list"></ul>
        <div id="popup" class="modal">
            <div class="modal-content">
                <p id="phrase"></p>
                <p id="meaning"></p>
            </div>
        </div>
        <script>
            let data = [];
            document.addEventListener("DOMContentLoaded", function () {
                loadData();
            });

            // JSONを読み込む
            function loadData() {
                const category = document.getElementById("category").value;
                const filename = `${category}`;

                fetch(filename)
                    .then(response => response.json())
                    .then(json => {
                        data = json;
                        filterList();
                    })
                    .catch(error => console.error("JSON の読み込みエラー:", error));
            }

            // フィルタ
            function filterList() {
                const selectedCategory = document.getElementById("filter").value;
                const listElement = document.getElementById("list");
                listElement.innerHTML = "";
                const filteredData = data.filter(item => item.type === selectedCategory);

                filteredData.forEach(item => {
                    const li = document.createElement("li");
                    li.textContent = item.phrase;
                    li.className = "list-item";

                    // モーダル表示処理
                    li.onclick = function () {
                        document.getElementById("phrase").textContent = item.phrase;
                        document.getElementById("meaning").textContent = item.meaning;
                        document.getElementById("popup").style.display = "flex";
                    };
                    listElement.appendChild(li);
                });
            }

            // リストを表示
            function renderList(filteredData) {
                const list = document.getElementById("list");
                list.innerHTML = "";
                filteredData.forEach(item => {
                const li = document.createElement("li");
                li.textContent = item.phrase;
                list.appendChild(li);
                });
            }

            // 背景クリックで閉じる
            document.getElementById("popup").addEventListener("click", function (event) {
            // popup-contentの外側がクリックされた場合のみ閉じる
            if (event.target === this) {
                this.style.display = "none";
            }
            });
        </script>
    </main>
</body>
</html>